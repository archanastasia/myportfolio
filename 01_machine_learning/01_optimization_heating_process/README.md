GO TO <a href="https://nbviewer.org/github/archanastasia/myportfolio/blob/main/01_machine_learning/01_optimization_heating_process/optimization_steel_heating_process.ipynb">OPEN FULL PROJECT VERSION</a>

`Machine learning` `Regression task` `Scikit-learn` `Research analysis` `Seaborn` `Matplotlib`

# Оптимизация процесса нагрева сплава
В данном проекте решалась задача машинного обучения.
Созданная модель должна помочь оптимизировать технологический процесс легирования сплава. Обработка осуществляется в несколько этапов:

Сталь нагревают до нужной температуры графитовыми электродами и замеряют температуру сплава в начале процесса.
Водятся легирующие материалы (вводятся сыпучие материалы и проволока). Сплав продувают инертным газом. Во время этого процесса температура на несколько минут повышается
Такой цикл повторяется до достижения целевого химического состава и оптимальной температуры плавки.
В дальнейшем модель поможет оптимизировать время нагрева сплава до нужной температуры (уменьшить кол-во итераций), в зависимости от количества используемых легирующих материалов и инертного газа.

# План работы
* Изучение поставленной задачи
* Изучение данных
* Загрузка данных
* Изучение и анализ данных (изучения таргета, взаимосвязь признаков, поиск кореляции, пути создания новых признаков)
* Оценка качества данных и описание (Оценка полноты данных, а также поиск путей работы с проблемами)
* Предобработка
* Приведение к единому формату
* Работа с выявленными проблемами и недостатками
* Обработка
* Объединение подготовленных таблиц
* Формирование признаков и таргета
* Формирование выборок
* Обучение моделей
* Можно обучить несколько моделей и проверить их качество с помощью кросс-валидации. Также изучить степень влияния каждого признака на модель. Возможно, после этого придется вернуться на этап анализа данных и подготовки признаков.
* Тестирование лучшей модели
* Сравнение с константной моделью.
* Отчет о проведенном иследовании. Вывод.

# Отчет
Нужный результат (Значение МАЕ на тестовой выборке < 8) был достигнут и обученные модели дают хорошие результаты как на обучающей выборке, так и на тестовой.
Ход работы двигался в соответствии с планом, но в процессе были внесены некоторые изменения.

В результате изучения данных были найдены проблемы - пропущенные значения, отсутствие замеров температуры для нескольких партий.
Данные были приведены к нужному типу.

Были созданы новые признаки, ускорившие скорость обучения:

работа (А). Были удалены из выборок активная, реактивная мощности, время старта и окончания нагрева.
Количество итераций нагрева сплава.
Изучение моделей показало, что эти признаки улучшают качество предсказаний.
В процессе предобработки были убраны данные о сыпучих и проволочных материалах, которые мало использовались в процессе изготовления сплава.
После обучения модели с этими признаками и без них, оказалось, что эти параметры улучшают результаты модели. Предположение об их неинформативности не подтвердилось. Результат при использовании этих признаков улучшается для моделей в среднем на 0.15

Предположение, что признак iterat может негативно влиять на обучение модели. Была попытка обучить модель с теми же гиперпараметрами, но без этого признака. Результат ухудшился на .03.

После признаки были объединены в одну таблицу, промасштабированы, затем разделены на признаки и целевой признак.

В итоге для обучения модели использовались агрегированные для каждой партии данные о выполняемой работе для нагрева сплава, времени нагрева, количестве итераций. Также : количестве сыпучих и проволочных материалов, объеме газа.

За время работы были выделены некоторые проблемы в данных, вызывающие сложности в работе.
Данные о времени загрузке материалов не использовались, так как они не синхронизированы для таблиц.
Для партий от 2500-ой есть только один замер температуры, те отсутствует целевой признак.

Были обучены регрессионные модели: CatBoost, LGBM, RandomForest, ElasticNetCV, LassoCV. С помощью кросс-валидации. Модели с лучшими результатами были проверены на тестовой выборке.

# Вывод
**Лучший результат показала модель CatBoost.**

CatBoostRegressor(verbose=True, random_state=151122, iterations=5000, learning_rate =0.01, early_stopping_rounds=100)

результат кросс-валидации на обучающей выборке - **MAE = 6.03** 

результат на тестовой выборке - **MAE = 6.18**

Константная модель показала результат 8.31 на тестовой выборке. Результат обученой модели значительно лучше.
